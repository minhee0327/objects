# ë¶€ë¡ A > ê³„ì•½ì— ì˜í•œ ì„¤ê³„

## ğŸ“Œ í•™ìŠµ ë‚´ìš© ìš”ì•½   
### ê³„ì•½ì— ì˜í•œ ì„¤ê³„ (Design by Contract, DBC)
- ê³„ì•½ì€ í˜‘ë ¥ì— ì°¸ì—¬í•˜ëŠ” ë‘ ê°ì²´ì‚¬ì´ì˜ ì˜ë¬´ì™€ ì´ìµì„ ë¬¸ì„œí™”í•˜ëŠ”ê²ƒ.
- ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ í”„ë¡œê·¸ë˜ë°í•˜ë¼ëŠ” ì›ì¹™ì„ í™•ì¥í•œ ê²ƒ.

- **ì‚¬ì „ì¡°ê±´**: ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ìœ„í•´ ë§Œì¡±ë¼ì•¼í•˜ëŠ” ì¡°ê±´, í´ë¼ì´ì–¸íŠ¸ì˜ ì˜ë¬´, ë©”ì„œë“œì— ë“¤ì–´ì˜¨ ì¸ìì˜ ì •í•©ì„±ì„ ì²´í¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©.
- **ì‚¬í›„ì¡°ê±´**: ë©”ì„œë“œê°€ ì‹¤í–‰ëœ í›„ì— í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ì¥í•´ì•¼í•˜ëŠ” ì¡°ê±´. 
  - ì‚¬ìš© ì˜ë„
    - ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ ìƒíƒœê°€ ì˜¬ë°”ë¥¸ì§€ 
    - ì „ë‹¬ëœ íŒŒë¼ë¯¸í„°ì˜ ê°’ì´ ì˜¬ë°”ë¥´ê²Œ ë³€ê²½ëëŠ”ì§€
    - ë°˜í™˜ê°’ì´ ì˜¬ë°”ë¥¸ì§€?
  - ì‚¬ì „ì¡°ê±´ë³´ë‹¤ ì–´ë ¤ìš´ì´ìœ 
    - í•œ ë©”ì„œë“œì•ˆì— ì—¬ëŸ¬ returnë¬¸ì´ ë‚˜ì˜¤ëŠ” ê²½ìš°
    - ì‹¤í–‰ ì „/í›„ì˜ ê°’ì„ ë¹„êµí•´ì•¼í•˜ëŠ” ê²½ìš°
- **ë¶ˆë³€ì‹**: ì¸ìŠ¤í„´ìŠ¤ ìƒëª…ì£¼ê¸° ì „ë°˜ì— ê±¸ì³ ì§€ì¼œì ¸ì•¼í•˜ëŠ” ê·œì¹™, ì¼ë°˜ì ìœ¼ë¡œ ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœì™€ ê´€ë ¨ì´ ìˆë‹¤.
  - ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ëœ í›„ì— ë§Œì¡±ë¼ì•¼í•œë‹¤.
  - ë©”ì„œë“œ ì‹¤í–‰ ì „ê³¼ ì¢…ë¥˜í›„ì—ëŠ” í•­ìƒ ë¶ˆë³€ì‹ì„ ë§ˆì¡±í•˜ëŠ” ìƒíƒœê°€ ìœ ì§€ë˜ì–´ì•¼í•œë‹¤.

### ê³„ì•½ì— ì˜í•œ ì„¤ê³„ì™€ ì„œë¸Œíƒ€ì´í•‘
ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜ì›ì¹™ì˜ ê·œì¹™ì„ 2ê°€ì§€ ì¢…ë¥˜ë¡œ ì„¸ë¶„í™”: **ê³„ì•½ ê·œì¹™ / ê°€ë³€ì„± ê·œì¹™**

#### ê³„ì•½ ê·œì¹™
> ìŠˆí¼íƒ€ì…ê³¼ ì„œë¸Œíƒ€ì… ì‚¬ì´ì˜   
> ì‚¬ì „ì¡°ê±´, ì‚¬í›„ì¡°ê±´, ë¶ˆë³€ì‹ì— ëŒ€í•´ ì„œìˆ í•  ìˆ˜ ìˆëŠ” ì œì•½ì— ê´€í•œ ê·œì¹™
- ì„œë¸Œíƒ€ì…ì— ë” ê°•ë ¥í•œ ì‚¬ì „ì¡°ê±´ì„ ì •ì˜í•  ìˆ˜ ì—†ë‹¤.
- ì„œë¸Œíƒ€ì…ì— ë” ì™„í™”ëœ ì‚¬í›„ì¡°ê±´ì„ ì •ì˜í•  ìˆ˜ ì—†ë‹¤.
- ìŠˆí¼íƒ€ì…ì˜ ë¶ˆë³€ì‹ì€ ì„œë¸Œíƒ€ì…ì—ì„œë„ ë°˜ë“œì‹œ ìœ ì§€ë˜ì–´ì•¼í•œë‹¤.
- Fail Fast: ì°¨ë¼ë¦¬ ë¬¸ì œê°€ ë°œìƒí•œ ìœ„ì¹˜ì—ì„œ í”„ë¡œê·¸ë¨ì´ ì‹¤íŒ¨í•˜ë„ë¡ ë§Œë“¤ì–´ë¼. ë¬¸ì œì˜ ì›ì¸ì„ íŒŒì•…í•˜ëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•ì€ ë¬¸ì œê°€ ë°œìƒí•˜ìë§ˆì í”„ë¡œê·¸ë¨ì´ ì¼ì° ì‹¤íŒ¨í•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ë‹¤.

#### ê°€ë³€ì„± ê·œì¹™
> íŒŒë¼ë¯¸í„°ì™€ ë¦¬í„´íƒ€ì…ì˜ ë³€í˜•ê³¼ ê´€ë ¨ëœ ê·œì¹™
- ì„œë¸Œíƒ€ì…ì€ ìŠˆí¼íƒ€ì…ì´ ë°œìƒì‹œí‚¤ëŠ” ì˜ˆì™¸ì™€ ë‹¤ë¥¸ íƒ€ì…ì˜ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼œì„œëŠ” ì•ˆëœë‹¤. 
- ì„œë¸Œíƒ€ì…ì˜ ë¦¬í„´íƒ€ì…ì€ ê³µë³€ì„±ì„ ê°€ì ¸ì•¼í•œë‹¤. 
- ì„œë¸Œíƒ€ì…ì˜ ë©”ì„œë“œ íŒŒë¼ë¯¸í„°ëŠ” ë°˜ê³µë³€ì„±ì„ ê°€ì ¸ì•¼í•œë‹¤. (ìë°”ëŠ” íŒŒë¼ë¯¸í„° ë°˜ê³µë³€ì„±ì„ í—ˆìš©í•˜ì§„ ì•ŠìŒ.)

#### í•¨ìˆ˜íƒ€ì…ê³¼ ì„œë¸Œíƒ€ì´í•‘
- ì´ë¦„ì—†ëŠ” ë©”ì„œë“œ ì •ì˜: ìµëª… í•¨ìˆ˜, í•¨ìˆ˜ ë¦¬í„°ëŸ´, ëŒë‹¤ í‘œí˜„ì‹
- ë©”ì„œë“œ íƒ€ì…/í•¨ìˆ˜íƒ€ì…: 
  ```skala
  IndependentPublisher => Book
  ```
- ë©”ì„œë“œ íƒ€ì…ì—ì„œ ì •ì˜í•œ ì‹œê·¸ë‹ˆì²˜ë¥¼ ì¤€ìˆ˜í•˜ëŠ” ë©”ì„œë“œë“¤ì€ ì¸ìŠ¤í„´ìŠ¤ë¡œ ê°„ì£¼í•œë‹¤.
  ```skala
  def sell(publisher: IndependentPublisher): Book = new Book(publisher)
  ```
  ```skala
  (publisher: IndependentPublisher) => new Book(publisher)
  ```
- í•¨ìˆ˜íƒ€ì…(ë©”ì„œë“œíƒ€ì…)ì˜ ì„œë¸Œíƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ìˆëŠ”ê°€? yes..!
  ```skala
  new Orderer().order((publisher: IndependentPublisher) => new Book(publisher))
  new Orderer().order((publisher: Publisher) => new Magazine(publisher))
  ```
  - íŒŒë¼ë¯¸í„° íƒ€ì… ë°˜ê³µë³‘ì 
  - ë¦¬í„´íƒ€ì… ê³µë³€ì 

## ğŸ’¡ ëŠë‚€ ì 
- ê°€ë³€ì„± ê·œì¹™ì„ ì´í•´í•˜ëŠ”ë° ì–´ë ¤ì› ë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.. ğŸ˜¹

## â“ ê¶ê¸ˆí•œ ì 
* p.566 ë§ˆì§€ë§‰ì—ì„œ 3ë²ˆì§¸ ì¤„: ìë°”ëŠ” ë¦¬í„´íƒ€ì… ê³µë³€ì„±ì„ ì§€ì›í•˜ëŠ”ë°, C#ì€ ë¦¬í„´íƒ€ì… ê³µë³€ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤..? (C#ë„ ìë°”ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì œë„¤ë¦­ì„ í™œìš©í•˜ë©´ ê°€ëŠ¥í•˜ë‹¤)
* p.570 ë§ˆì§€ë§‰ì— new Orderer() -> Customer() ì¸ê±°ê² ì£ ...??: yes!
* p.571 ì—ì„œ ìë°”ì˜ ê²½ìš° new Customer().order((publisher: Publisher => new Magazine(publisher))ê°€ ë  ìˆ˜ ìˆëŠ”ì§€?
  * ê²°ë¡ (ë‹µë³€) : ìë°”ëŠ” íŒŒë¼ë¯¸í„° ë°˜ê³µë³€ì„±ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ëŒ€ì‹ , <? super Publiher> ì²˜ëŸ¼ ì œë„¤ë¦­ì„ ì´ìš©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ğŸ”— ì°¸ê³  ë§í¬
ì‚¬í›„ì¡°ê±´ p543 ë§ˆì§€ë§‰ ì½”ë“œ (Contract.Ensure ì‚¬ìš©í•œ)ë¥¼ ìë°”ë¡œ ë°”ê¿”ë‹¬ë¼ê³  GPTì— ë¬¸ì˜
```java
public class Audience {
    private Bag bag;

    public BigDecimal buy(Ticket ticket) {
        BigDecimal result;

        if (bag.isInvited()) {
            bag.setTicket(ticket);
            result = BigDecimal.ZERO;
        } else {
            bag.setTicket(ticket);
            bag.minusAmount(ticket.getFee());
            result = ticket.getFee();
        }

        return Contract.ensure(result, r -> r.compareTo(BigDecimal.ZERO) >= 0, "Buy result must be >= 0");
    }
}

public class Contract {
  public static <T> T ensure(T result, Predicate<T> condition, String message) {
    if (!condition.test(result)) {
      throw new IllegalStateException(message);
    }
    return result;
  }
}
```
ë¶ˆë³€ì‹ì€ ìë°”ë¡œ ì–´ë–»ê²Œ ì´í•´í•˜ëƒê³  í–ˆì„ ë•Œ ë‹µë³€
```java
public class Invitation {
    private final LocalDateTime when;

    public Invitation(LocalDateTime when) {
        this.when = when;
        checkInvariant(); // ìƒì„±ìì—ì„œ ë¬´ê²°ì„± ê²€ì‚¬
    }

    public LocalDateTime getWhen() {
        checkInvariant();  // ë©”ì„œë“œ ìˆ˜í–‰ ì „í›„ì— ë¶ˆë³€ì„± ìœ ì§€ í™•ì¸
        return when;
    }

    private void checkInvariant() {
        if (this.when == null) {
            throw new IllegalStateException("when must never be null");
        }
    }
}
```
